<form [formGroup]="fform">
  <div class="in-the-header">
    <div class="flex-container">

        <md-input-container>
          <input mdInput [placeholder]="btity.titles.vehicles.vin" formControlName="vin">
        </md-input-container>
      <ng-container *ngIf="isNew">
        <md-input-container>
          <input mdInput [placeholder]="btity.titles.vehicles.vinConfirm" formControlName="vinConfirm">
        </md-input-container>
        <!--<span class="errorMessage vertical-middle-span"
          *ngIf="fform.get('vinConfirm').errors && fform.get('vinConfirm').errors.duplicateVIN"
        >VIN 已存在</span>-->
        <!--<span class="vertical-middle-span"
          *ngIf="asyncMon.progressing.validatorDuplicateVIN"
        ><md-spinner class="inline-spinner"></md-spinner></span>-->

      </ng-container>
      <span class="space-filler"></span>

      <ng-container *ngIf="!isNew">
        <md-input-container class="xl-size-input">
          <small>
            <input mdInput [placeholder]="btity.titles.vehicles.mofcomRegisterRef" 
              formControlName="mofcomRegisterRef">
          </small>
        </md-input-container>   
      </ng-container>
    </div>
  </div>

  <!-- show this div after vehicle is deleted -->
  <div class="flex-container" *ngIf="vehicle.metadata.isDeleted">
    <app-autocomplete-combo
      [isTrueOrFalse]="true"
      [placeholderInput]="btity.titles.metadata.isDeleted"
      [formControlInput]="fform.get('metadata.isDeleted')"
      sizeClass='s-size-input'
    >
    </app-autocomplete-combo>   

    <!--<span class="space-filler"></span>-->

    <md-input-container class="xxl-size-input">
      <input mdInput 
        [placeholder]="btity.titles.metadata.deletedFor" 
        [formControl]="fform.get('metadata.deletedFor')">
    </md-input-container>
  </div>


  <md-card class="info-card">
    <md-card-header>
      <md-card-title class="vertical-center-container">
        <i class="material-icons">chevron_right</i>
        <span>{{btity.titles.vehicles.title}}</span>
      </md-card-title>
    </md-card-header>
    <md-card-content>
      <div>
        <!-- 收车单位 -->
        <app-autocomplete-combo
          [placeholderInput]="btity.titles.vehicles.facility"
          [formControlInput]="fform.get('facility')"
          [objList]="btity.types.facilities"
          [toSort]="false"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>

        <!-- 进场日期 -->
        <md-input-container class="l-size-input">
          <input type="date" mdInput [placeholder]="btity.titles.vehicles.entranceDate" 
            [formControl]="fform.get('entranceDate')">
        </md-input-container>
          

        <app-autocomplete-combo
          [placeholderInput]="btity.titles.vehicles.internalSurveyor"
          [formControlInput]="fform.get('internalSurveyor')"
          [objList]="btity.staffs"
          [objListTitleKey]="'displayName'"
          [toSort]="false"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>

        <!-- <md-input-container class="m-size-input">
            <input mdInput [placeholder]="btity.titles.vehicles.internalSurveyor" 
              [formControl]="fform.get('internalSurveyor')">
        </md-input-container> -->

        <!-- 商务部登记类别 -->
        <app-autocomplete-combo
          [placeholderInput]="btity.titles.vehicles.mofcomRegisterType"
          [formControlInput]="fform.get('mofcomRegisterType')"
          [objList]="btity.types.mofcomRegisterTypes"
          [toSort]="false"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>

        <!-- 申请人委托 -->
        <app-autocomplete-combo
          [placeholderInput]="btity.titles.vehicles.consignmentType"
          [formControlInput]="fform.get('consignmentType')"
          [objList]="btity.types.consignmentTypes"
          [toSort]="false"
          sizeClass='xl-size-input'
        >
        </app-autocomplete-combo>


      </div>
      <div>
        <!-- 车辆来源 -->
        <app-autocomplete-combo
          [placeholderInput]="btity.titles.vehicles.source"
          [formControlInput]="fform.get('source')"
          [objList]="btity.types.sources"
          [toSort]="false"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>

        <md-input-container class="xl-size-input" *ngIf="fform.get('source').value === '交警'">
            <input mdInput [placeholder]="btity.titles.vehicles.batchId" 
              [formControl]="fform.get('batchId')">
        </md-input-container>

        <app-autocomplete-combo *ngIf="fform.get('status2.isDismantlingReady').value"
          [isTrueOrFalse]="true"
          [placeholderInput]="btity.titles.vehicles.status2.isDismantlingReady"
          [formControlInput]="fform.get('status2.isDismantlingReady')"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>


      </div>

      <div class="flex-container" *ngIf="!fform.get('status2.isDismantlingReady').value">
        <!-- 可否拆解 -->
        <app-autocomplete-combo
          [isTrueOrFalse]="true"
          [placeholderInput]="btity.titles.vehicles.status2.isDismantlingReady"
          [formControlInput]="fform.get('status2.isDismantlingReady')"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo>
        <!-- <span class="separator-in-flex-container"></span> -->
        <md-input-container class="xxl-size-input">
          <input mdInput 
            [placeholder]="btity.titles.vehicles.status2.isDismantlingNotReadyReason" 
            [formControl]="fform.get('status2.isDismantlingNotReadyReason')">
        </md-input-container>
        
      </div>

      <div class="flex-container">
        <md-select class="scale-down-filter-90" [placeholder]="btity.titles.vehicles.surveyRounds" [formControl]="fform.get('surveyRounds')">
          <md-option *ngFor="let option of surveyRoundsHash" [value]="option.value">
            {{ option.displayValue }}
          </md-option>
        </md-select>

        <!-- <app-autocomplete-combo
          [isTrueOrFalse]="true"
          [placeholderInput]="btity.titles.vehicles.isSurveyNecessary"
          [formControlInput]="fform.get('isSurveyNecessary')"
          sizeClass='m-size-input'
        >
        </app-autocomplete-combo> -->
        <ng-container *ngIf="fform.get('surveyRounds').value !== 'zero'">
          <!-- 可否验车 -->
          <app-autocomplete-combo
            [isTrueOrFalse]="true"
            [placeholderInput]="btity.titles.vehicles.status2.isSurveyReady"
            [formControlInput]="fform.get('status2.isSurveyReady')"
            sizeClass='m-size-input'
          >
          </app-autocomplete-combo>
          <!-- <span class="separator-in-flex-container"></span> -->
          <md-input-container class="xxl-size-input" *ngIf="!fform.get('status2.isSurveyReady').value">
            <input mdInput 
              [placeholder]="btity.titles.vehicles.status2.isSurveyNotReadyReason" 
              [formControl]="fform.get('status2.isSurveyNotReadyReason')">
          </md-input-container>
          <ng-container *ngIf="fform.get('status2.isSurveyReady').value">

            <md-input-container class="l-size-input">
              <input mdInput type="date"
                [placeholder]="btity.titles.vehicles.estimatedSurveyDateFirst"
                [formControl]="fform.get('estimatedSurveyDateFirst')">
            </md-input-container>
            <span style="display: inline-block; width: 2em;"></span>
            <md-input-container class="l-size-input" *ngIf="fform.get('surveyRounds').value === 'two'">
              <input mdInput type="date"
                [placeholder]="btity.titles.vehicles.estimatedSurveyDateSecond"
                [formControl]="fform.get('estimatedSurveyDateSecond')">
            </md-input-container>

          </ng-container>
        </ng-container>    


      </div>

    </md-card-content>
  </md-card>



</form>